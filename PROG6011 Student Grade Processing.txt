IDENTIFICATION DIVISION.
PROGRAM-ID. STUDENTGRADEPROCESSING.
DATA DIVISION.

FILE SECTION.
FD INPUT-FILE.
01 STUDENT-RECORD.
   05 STUDENT-ID       PIC X(10).
   05 STUDENT-NAME     PIC X(30).
   05 MARKS            OCCURS 5 TIMES.
      10 SUBJECT-MARK  PIC 9(3).

FD OUTPUT-FILE.
01 GRADE-RECORD.
   05 STUDENT-ID-OUT   PIC X(10).
   05 STUDENT-NAME-OUT PIC X(30).
   05 TOTAL-MARKS      PIC 9(5).
   05 AVERAGE-MARKS    PIC 9(5)V99.
   05 GRADE            PIC X(2).

WORKING-STORAGE SECTION.
01 SUBJECT-COUNT             PIC 9 VALUE 5.                   
01 MAX-MARK                  PIC 9(3) VALUE 100.              
01 MIN-PASS-MARK             PIC 9(3) VALUE 040.              
01 FIRST-MARK                PIC 9(3) VALUE IS 060 THRU 100.  
01 SECOND-MARK               PIC 9(3) VALUE IS 050 THRU 059.  
01 THIRD-MARK                PIC 9(3) VALUE IS 040 THRU 049.  
01 FIRST-GRADE               PIC X VALUE 'A'.                 
01 SECOND-GRADE              PIC X VALUE 'B'.                 
01 THIRD-GRADE               PIC X VALUE 'C'.                 
01 FAILING-GRADE             PIC X VALUE 'F'.                 .

PROCEDURE DIVISION.
    OPEN INPUT INPUT-FILE
         OUTPUT OUTPUT-FILE.

    PERFORM READ-STUDENT-RECORD UNTIL FILE-EOF
    DISPLAY "PROCESSING COMPLETED."

    CLOSE INPUT-FILE
          OUTPUT-FILE.

    STOP RUN.

READ-STUDENT-RECORD.
    READ INPUT-FILE
        AT END SET FILE-EOF TO TRUE
        NOT AT END PERFORM CALCULATE-GRADE.

CALCULATE-GRADE.
    MOVE ZEROS TO TOTAL-MARKS
    PERFORM VARYING IDX FROM 1 BY 1 UNTIL IDX > SUBJECT-COUNT
        ADD SUBJECT-MARK(IDX) TO TOTAL-MARKS
    END-PERFORM

    COMPUTE AVERAGE-MARKS = TOTAL-MARKS / SUBJECT-COUNT

    IF AVERAGE-MARKS >= MIN-PASS-MARK
        MOVE PASSING-GRADE TO GRADE
    ELSE
        MOVE FAILING-GRADE TO GRADE
    END-IF

    MOVE STUDENT-ID TO STUDENT-ID-OUT
    MOVE STUDENT-NAME TO STUDENT-NAME-OUT
    MOVE TOTAL-MARKS TO TOTAL-MARKS
    MOVE AVERAGE-MARKS TO AVERAGE-MARKS

    WRITE GRADE-RECORD.

    MOVE SPACES TO STUDENT-RECORD
    MOVE SPACES TO GRADE-RECORD.

    EXIT.

FILE-EOF.
    EXIT.










